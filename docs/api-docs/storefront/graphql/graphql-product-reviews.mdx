# Product Reviews with the GraphQL Storefront API









## Authentication




## Store settings

There are a few store settings to consider when creating a product review:

- General 'enable product reviews' setting.
- 'Only allow reviews from previous customers' setting.
- Recaptcha setting

**Overall 'enable product reviews'**

The merchant must enable this overall setting for the review submission process to work. Disabling this setting cancels any attempts to submit reviews.

**'Only allow reviews from previous customers'**

When the merchant enables the 'only allow reviews from previous customers' setting, only logged-in customers (not guest shoppers) can submit a review, and they must have at least one previous order placed in the store.
This setting ensures the merchant has a genuine customer to contact if needed.
The order doesn't have to include the product being reviewed. Once a purchase has been made, customers can review any item in the store.

When the merchant disables the setting, guest shoppers can also submit reviews, but they must provide an email. Since guests are not logged in, they must supply the email in the request as an input parameter.
Logged-in customers don't need to provide the email through the input parameter, as the system will use the email from the customer's account.
If the logged-in customer provides an email as an input, BigCommerce will validate the email against the email associated with the shopper's account. If the email doesn't match, the submission will fail.

<Callout type="info">
  #### Technical considerations 
  In all cases, only one review per product is allowed per email address.
</Callout>

**Recaptcha**

If a merchant enables the [recaptcha setting](https://support.bigcommerce.com/s/article/Updating-Themes-with-reCAPTCHA-v2) on the storefront, you need to send a recaptcha token with the request.

## Mutation

The following mutation creates a product review for a store.


<Tabs items={['Request', 'Response']}>
<Tab>

```gql filename="Example request: Create a product review" lineNumbers copy
mutation {
  catalog {
    addProductReview (
      input: {
        productEntityId: 81
          review: {
            title: "teitle"
            text: "textr"
            author: "oman"
            rating: 4  # integer value between 1 and 5
            email: "mem@ail.com2"
        }
      }
    ){
      errors {
        ...on NotAuthorizedToAddProductReviewError {
          message
        }
        ...on CustomerAlreadyReviewedProductError {
          message
        }
        ...on ProductIdNotFoundError {
          message
        }
        ...on InvalidInputFieldsError {
          message fields
        }
        ...on Error{
          message
        }
      }
    }
  }
}
```

</Tab>
<Tab>

```json filename="Example success response: Create a product review" lineNumbers copy
{
  "data": {
    "catalog": {
      "addProductReview": {
        "errors": []
      }
    }
  }
}
```

</Tab>
</Tabs>


## Query


You can query the product review with the `products` graphql node.

<Tabs items={['Request', 'Response']}>
<Tab>

```gql filename="Example request: Query a product review" lineNumbers copy
query {
  site {
    products (entityIds: [81]) {
      edges {
        node {
          reviews {
            edges {
              node {
                entityId
                author {
                  name
                }
                title
                text
                rating
                createdAt {
                  utc
                }
              }
            }
          }
        }
      }
    }
  }
}
```

</Tab>
<Tab>

```json filename="Example response: Query a product review" lineNumbers copy
{
  "data": {
    "site": {
      "products": {
        "edges": [
          {
            "node": {
              "reviews": {
                "edges": [
                  {
                    "node": {
                      "entityId": 3,
                      "author": {
                        "name": "oman"
                      },
                      "title": "teitle",
                      "text": "textr",
                      "rating": 4,
                      "createdAt": {
                        "utc": "2024-05-15T15:16:30Z"
                      }
                    }
                  }
                ]
              }
            }
          }
        ]
      }
    }
  }
}
```

## Resources